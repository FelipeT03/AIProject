function [BW,maskedImage] = segmentImage(X)
%segmentImage Segment image using auto-generated code from imageSegmenter app
%  [BW,MASKEDIMAGE] = segmentImage(X) segments image X using auto-generated
%  code from the imageSegmenter app. The final segmentation is returned in
%  BW, and a masked image is returned in MASKEDIMAGE.

% Auto-generated by imageSegmenter app on 18-Nov-2020
%----------------------------------------------------


% Adjust data to span data range.
X = imadjust(X);

% Graph cut
foregroundInd = [2593 3146 3699 4253 4806 5356 5358 5632 5908 6184 6186 6460 6736 7012 7014 7564 8669 8946 10317 10326 10879 11431 12536 13916 13917 14469 15572 15574 16127 16403 16676 16679 17231 17507 17780 17783 18059 18332 18335 18611 18887 19160 19439 19715 19988 20264 20543 21644 21647 22195 23303 23851 23854 24678 24953 24957 25505 25509 26060 26333 26612 26885 27164 27713 27715 28542 29093 29369 29645 29921 30197 30473 31577 31853 32956 32957 33508 34611 34613 35439 35717 36267 37095 37373 37647 38199 38750 39026 39028 39854 40407 40682 40683 41234 41786 42063 42338 42614 42890 43442 43445 44270 44549 45098 45378 45926 45930 46482 47030 47034 47306 48134 48138 48686 48965 49790 49793 50342 51170 51173 51722 51998 52550 52553 53105 53378 53657 54206 54209 54485 55310 55313 55862 56417 56690 57242 57245 57794 58070 58349 58898 59174 59725 59729 60277 60828 61109 61380 61661 62207 62483 63041 63311 63869 64691 65249 65519 65525 66347 66629 67175 67457 68003 68561 69113 69658 70493 70762 71865 72141 72149 73245 73253 73797 73806 74349 74911 75177 75729 76005 76016 76292 76833 77385 77396 77661 78213 78224 78776 79041 79593 79879 80145 80431 80697 80983 81250 81259 81526 81811 82078 82906 82915 83458 84010 84019 84562 84571 85114 85123 85390 85942 85951 86502 86770 87330 87598 87606 88434 88703 89262 89538 89808 89814 90084 90366 90913 90918 91465 91470 91741 92017 92293 92298 92845 92849 93121 93125 93397 93401 93677 93949 93953 94225 94229 94505 94777 94781 95057 95329 95332 95881 95884 96159 96435 96711 96985 96987 97263 97537 97815 98091 98365 98367 98643 98919 99195 99469 99470 99471 99746 100022 100297 100573 ];
backgroundInd = [4002 4003 4279 4832 5937 6765 6803 6814 6827 7349 7896 7940 8145 8776 8997 9608 9801 10099 10163 10441 10442 10444 10448 10455 10464 10473 10478 10479 11733 11753 12856 13665 13958 14510 14786 15338 15394 15597 15615 16444 16701 16977 17274 17805 17829 18357 18661 18909 18940 19218 19496 19737 19773 19774 19776 20289 20331 20610 20892 21452 21735 21947 22296 23132 23968 24155 24801 25359 25812 25915 27192 27301 27583 27860 28136 28296 28412 29124 30228 30342 31055 32159 32711 32823 33263 33539 34367 35305 35471 36575 36851 37510 38230 38612 39163 39334 39886 39990 40540 40990 41364 41818 42463 42646 43474 43835 44026 45130 45209 46031 46510 47131 47679 48227 48495 48497 48500 48718 49040 49044 50098 50138 50411 51754 51785 52582 52858 52883 53686 53962 53984 54238 54789 54809 55341 55635 56186 56444 56720 56737 57823 57841 58945 59203 59497 60030 60325 60858 61409 61982 62237 63340 63365 64194 64748 64995 65025 65854 65904 66098 66180 66456 66732 66926 66960 67284 67477 67790 67836 68029 68305 68388 68621 68664 68857 68940 69451 69685 70513 70559 71113 71893 72222 72498 73053 73824 74160 74438 74992 75204 75823 76307 76376 76653 76859 76931 77411 77486 77963 78042 78515 78601 79343 79712 80448 80548 81553 81660 82105 82215 83048 83761 83881 84313 84716 85141 85548 85693 86105 86382 86521 86658 87074 87211 87626 87763 88315 88731 89144 90112 90249 90388 90801 91353 91768 91904 92597 92732 93426 93558 93702 94386 94533 94809 95088 95489 95644 96201 96481 96591 97036 97315 97318 97320 97321 97325 97331 97336 97343 97418 97625 97904 97969 98183 98244 98461 98519 98740 99021 99024 99069 99306 99341 99589 99598 99607 99613 ];
L = superpixels(X,619);
BW = lazysnapping(X,L,foregroundInd,backgroundInd);

% Active contour
iterations = 100;
BW = activecontour(X, BW, iterations, 'Chan-Vese');

% Open mask with disk
radius = 10;
decomposition = 0;
se = strel('disk', radius, decomposition);
BW = imopen(BW, se);

% Create masked image.
maskedImage = X;
maskedImage(~BW) = 0;
end

